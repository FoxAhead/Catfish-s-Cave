<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

  <head>
    <title>Catfish's Cave - Archived Main</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <meta name="author" content="Catfish">
    <meta name="description" content="Resources for Civilization 2: Test of Time.">
    <meta name="keywords" content="Civilization 2, Civilization II, Test of Time, Civ2, Civ 2, ToT, Civ2 units, Civilization 2 units, ToT units, Test of Time units, Civilization 2 graphics, Test of Time graphics, Civ2 graphics, Civ 2 graphics, ToT graphics, scenarios, War of the Ring, Lord of the Rings, Catfish">
    <link href="cave.css" rel="stylesheet" type="text/css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
  </head>

  <body>

    <div><img src="images/Cave.png" width="660" height="100" alt="Catfish's Cave - Resources For Civilization 2: Test of Time"></div>

    <div class="SideBar">
      <ul class="menu">
        <li><p><a title="Catfish's Cave Homepage" href="index.htm">Main</a></p></li>
        <li><p><a title="Frequently Asked Questions." href="jp_faq.htm">FAQ</a></p></li>
        <li><p><a title="Design guides for Test of Time." href="jp_guides.htm">Guides</a></p></li>
        <li><p><a title="Download the War of the Ring scenario." href="jp_wotr.htm">War of the Ring</a></p></li>
        <li><p><a title="24-bit units for Test of Time." href="jp_units.htm">Units</a><br>(last modified<br>25/05/2009)</p></li>
        <li><p><a title="24-bit terrain graphics for Test of Time." href="jp_terrain.htm">Terrain</a><br>(last modified<br>24/05/2009)</p></li>
        <li><p><a title="Modpacks, People, Icons, Wonders, etc." href="jp_miscgraphics.htm">Miscellaneous Graphics</a><br>(last modified<br>27/08/2012)</p></li>
        <li><p><a title="Links to useful websites related to Civ2 scenarios and their design." href="jp_links.htm">Links</a></p></li>
      </ul>
    </div>
    <div class="SideBarBot"><p></p></div>

    <div class="content" style="min-width: 480px">

      <h1>Archived Main</h1>

      <div class="post" id="P20091204">
        <div class="title">
          <h3><span class="date">4/12/2009 </span>Test of Time and Windows 7 Compatibility</h3>
        </div>

        <p>I installed Microsoft Windows 7 Ultimate 32-bit yesterday. After reading comments regarding its incompatibility with Civilization 2, I decided to install Test of Time and work my way through using the War of the Ring scenario. The first problem was the batch file installers - no surprise there. Copying files to a parent directory doesn't work: access is denied. When running these batch files as administrator, <i>none</i> of the copy commands work. It seems the only way to resolve this is to turn off User Account Control completely. With that sorted, and my modified GUI and scenario files installed, it was time to play the game.</p>
        
        <p>The game launched without a hitch; no compatibility mode required. However, when the game tried to play AVI files using the latest Indeo codec, I was presented with a black screen. Not good; the scenario's events rely heavily on AVIs. I'd already installed the <a href="http://www.free-codecs.com/download/K_Lite_Mega_Codec_Pack.htm">K-Lite Mega Codec Pack</a>, which includes Indeo 5, but the OS wasn't recognising it. Registering the DLL by entering "regsvr32 ir50_32.dll" at the Command Prompt solved the problem. I have video. Heh. There I was thinking I'd have to run the game in Windows XP Mode (only available for the Professional version of Windows 7 or higher). I guess a War of the Ring maintenance release, with additional installation instructions, is in order.</p>

        <h4>Addendum (20/12/2009):</h4>

        <p>Since posting this entry, I've managed to run the game in Windows 7 64-bit, both natively and in Windows XP Mode:</p>
        
        <blockquote><p class="tipblock">Briefly tested ToT on a 64-bit version of Windows 7 yesterday. Firstly, I tried it in the 64-bit environment using Timbatron's CPU-fixed executable, patched with MastermindX's 64-bit compatibility fix. It seemed to run fine. Again, I needed to register the Indeo 5 codec to get video. This was done by typing "regsvr32 C:\Windows\SysWOW64\ir50_32.dll" in the Search Box in the Start Menu. I also installed ToT in Windows XP Mode. Timbatron's CPU fix was used. This installation seemed to work OK as well, if not a little sluggish compared to the previous.</p></blockquote>
                
        <p>That quote, along with further discussion of Windows 7 and Test of Time compatibility, can be found in <a href="http://apolyton.net/showthread.php/189134-Damn-you-Windows-Vista!-%28part-342%29">this thread</a> at Apolyton. I've also updated the <a href="files/WotR/Readme.htm#Installation">Readme file</a> for the War of the Ring scenario with additional installation instructions for Windows 7 and Vista users.</p>

        <p><img src="images/HillGiant.gif" width="54" height="56" alt="Catfish"></p>
      </div>

      <div class="post" id="P20090526">
        <div class="title">
          <h3><span class="date">26/05/2009 </span>Site Maintenance</h3>
        </div>

        <p>Over the past few nights I've been buggering around with the site. Long overdue, I found myself cleaning up code, formatting documents and removing dead links, etc. I even changed the site's horrid brown banner after all these years. I've also added another modpack to the Miscellaneous Graphics section, and dumped a load of units and terrain in those sections. I just thought you should know that. See, I do think about Civ2 from time to time.</p>

        <p><img src="images/Elf-lord.gif" width="56" height="56" alt="Catfish"></p>
      </div>

      <div class="post" id="P20080920">
        <div class="title">
          <h3><span class="date">20/09/2008 </span>A New Age of Darkness?</h3>
        </div>

        <p>That War of the Ring scenario... yeah, the one that's been sitting on my hard disk for aeons, well, I've decided to make the beta version available for download. Knock knock, does anyone play Civilization 2 any more? You can find the link in the site menu. I'll make updates when the mood takes me.</p>

        <p><img src="images/Shelob.gif" width="64" height="49" alt="Catfish"></p>
      </div>

      <div class="post" id="P20061004">
        <div class="title">
          <h3><span class="date">4/10/2006 </span>Throw another Catfish on the CPU</h3>
        </div>

        <p>Predictions are for more stinking hot temperatures down under this summer. The last thing I need is my CPU running flat out for absolutely no reason. That's what Civilization 2 does to your system; even when idle the game uses 100% of available CPU resources, causing temperatures to rise and system fans to hit turbo mode. The maximum thermal power of today's CPUs far outstrips those of a decade ago when Civilization 2 was released and this archaic game was fast heading towards extinction on my computer until Timbatron rolled up in the <a href="http://forums.civfanatics.com">Civilization Fanatics' Center forums</a> with a solution. He's written patches for both the ToT and MGE versions of the game. You can download these files from <a href="http://tim.strafenet.com/">Tim's Code Archive</a>. It's likely that there'll only be a small window of opportunity to test these out (he's a busy guy), so if you've got anything to add, do it in <a href="http://forums.civfanatics.com/showthread.php?t=112086">this thread</a> and do it quickly. Oh yes, and you can thank him for his efforts by clicking on his Google ads.</p>

        <p><img src="images/Ent.gif" width="43" height="56" alt="Catfish"></p>
      </div>

      <div class="post" id="P20060818">
        <div class="title">
          <h3><span class="date">18/08/2006 </span>From the Forge of Mount Doom</h3>
        </div>

        <p>Time for another one of those War of the Ring scenario updates. Over the past several days I've been turning out a few units and fixing up some old ones. I still have just over a dozen place-holders to go. All of the remaining graphics, ie, the terrain, cities, people, icons, improvements and wonders are done. I finished mixing the last of the scenario's sounds a few days ago. The events, rules and other text files are virtually complete - I mean you could keep tweaking these things until the cows come home. What remains is the documentation and a few entries in the describe.txt file. I made changes to the events and rules files following my last playtest (probably around the time I last updated this page), so another round of playtesting is required; the area around Dale and northern Mirkwood is most affected. But, first things first, let's see if I can stick with it and get the rest of these units done.</p>

        <p><img src="images/Balrog.gif" width="61" height="58" alt="Catfish"></p>
      </div>

      <div class="post" id="P20060615">
        <div class="title">
          <h3><span class="date">15/06/2006 </span>Fungal Spores and Urticating Hairs</h3>
        </div>

        <p>Gee, it's been a long time since I updated this site's main page. However, I've not been completely idle; the <a href="jp_guides.htm">Guides</a> section has been updated several times during the last 6 months. Two months ago a number of packs in the <a href="jp_miscgraphics.htm">Miscellaneous Graphics</a> section received significant updates. I even worked on my War of the Ring scenario over the past week; the first time since the end of last year. Even made a few more units and tweaked some old ones - don't do that much any more. Here's a screenshot showing a sample of units created since my last update; people seem to like that sort of thing. What've we got here? Rangers, Gandalf the White, Radagast the Brown, Éomer, Éowyn, Elven spearmen, Gollum, Olog-hai, Lord of the Nazgûl, wolves and spearmen. I've added team colour masks to some units in the scenario (eg, the spearmen). They came out better than I thought. On the downside, it blows out the size of the static sprite file to over 800 kB.</p>

        <p><img class="framed" src="images/WotR_UnitsSample.jpg" width="450" height="150" alt="WotR Units"></p>

        <p><img src="images/Vampiress.gif" width="46" height="50" alt="Catfish"></p>
      </div>

      <div class="post" id="P20050906">
        <div class="title">
          <h3><span class="date">6/09/2005 </span>War of the Ring Update - Battling the AI</h3>
        </div>

        <p>It's been a while since I've provided an update for this project. For anyone who cares: it isn't dead. I hadn't worked on the scenario to any great extent since the beginning of the year, but during the last week or so, I've spent a few late nights playtesting it. The main obstacle to completion has really been the AI's inability to focus attacks against specific targets, compounded by its annoyingly weak path-finding. Impassable terrain barriers (there are a lot of them in Middle-earth) pose significant problems for the scenario's AI opponents. This has frustrated me no end. Mordor generally performs well; Minas Tirith gets a real hammering once Mordor becomes mobilised. Saruman has played well also - perhaps too well and has been toned down somewhat. It's Mordor's allies, the Haradrim and the Easterlings, which are the most disappointing, especially the latter. It would be nice to see the Men of Rhûn hit the player's northern cities hard without me having to resort to flooding the map with units. Anyway, after more than a dozen playtests the game is something approaching satisfactory. Fingers crossed I don't get sick of the sight of it - again.</p>

        <p><img src="images/Archer.gif" width="48" height="50" alt="Catfish"></p>
      </div>

      <div class="post" id="P20050604">
        <div class="title">
          <h3><span class="date">4/06/2005 </span>New version of MapCopy with ToT support</h3>
        </div>

        <p>James "Dusty" Reichwein has released a <a href="http://forums.civfanatics.com/showthread.php?t=112618">new version of MapCopy</a> which includes support for the Test of Time saved game format. This follows a <a href="http://forums.civfanatics.com/showthread.php?t=110600">discussion</a> about AI and map fertility over in CFC's Civ2 Scenario Creation forum. If you find any bugs, post them in the download thread. From the horse's mouth:</p>

        <blockquote class="textblock">This software is a Release candidate. If I don't hear any complaints by June, 30, 2005, I will release it as the final 1.2 version of MapCopy.</blockquote>

        <p>So what does it do? MapCopy is a utility program that can copy map data to and from .mp and .sav files, or modify existing values within such files. These data include: resource seeding, tile fertility and ownership, terrain improvements, land mass indices, map visibility and city radii. Alterations can be made on a mass scale, removing the need for painful hex editing. Yes, MapCopy uses command lines. Oh come on, don't be such a big nancy.</p>

        <p><img src="images/Copper.gif" width="63" height="46" alt="Catfish"></p>
      </div>

      <div class="post" id="P20050413">
        <div class="title">
          <h3><span class="date">13/04/2005 </span>Why are my PNG files so dark?</h3>
        </div>

        <p>Me thinks it's time to go on a rant about PNG files and gamma levels. As more scenario designers are recognising the advantages of ToT over older versions of Civ2, there's been a rise in the number of 24-bit graphics floating around the Civ2 forums. Consequently there's also been a rise in the incidence of PNG files posted with incorrect gamma levels.</p>

        <p>BMP is the required format for ToT graphics, but such files are not suited to web pages due to their large size; they're uncompressed. You can zip them up, but ZIP files don't make good previews. PNG files, which are both compressed and lossless, are an excellent alternative. However, there is one problem: PNG files contain a 4-byte gamma value called the gAMA chunk. Its function is to allow applications to (somewhat) standardise gamma levels across different platforms, eg, the gAMA chunk would allow an application to correct for the fact that PCs use a higher gamma level than Macs. Everything would be fine and dandy if applications used the value correctly - or failing that, totally ignored it - but of course the most widely used web browser on the planet, Internet Explorer 6, has to make a hash of it, doesn't it?</p>

        <p>When viewed using IE, the mid-tones of PNG files containing the gAMA chunk set to the standard PC value (45455) will appear too dark. Look at the example below. The first row displays the correct gamma levels; the second row shows how IE displays the same graphics when standardised for the PC. If you can't see a difference, get your eyes tested.</p>

        <p><img src="images/Gamma_Test.png" width="261" height="131" alt="Effect of Internet Explorer 6 on Gamma"></p>

        <p>Is this a problem? Well, yes it is. Not only will IE users be viewing something that differs from the original, but there's also a risk that users will copy the corrupted graphics from their browser window directly to their game files. Using a download accelerator or the 'Save Picture As...' option will bypass the mess, but on some websites (eg, Apolyton) I've found that these options are frequently unavailable (probably due to my firewall, ad-blocking and anti-virus software) and the only way to get at the original graphics is to save the entire web page. Either that or use another browser entirely (I use both Firefox and IE) - but you can't make everybody on the planet stop using IE. The simplest solution is to eliminate the source of problem, ie, the gAMA chunk.</p>

        <p>When a PNG is saved using a graphics editor such as Paint Shop Pro, Photoshop or MS Paint, the gAMA chunk is automatically written to the file. How do you get rid of it? It's pretty simple: get your hands on PNGOut over at <a href="http://advsys.net/ken/utils.htm">Ken Silverman's Utility Page</a> or if you don't like command line stuff, <a href="http://pnggauntlet.com/">PNGGauntlet</a>, which provides a nice User Interface for PNGOut and includes batch processing, ie, it can do multiple files in a single operation. Both sites have updated recently; in fact I use PNGGauntlet with the most recent version of PNGOut. Run either of these utilities with default settings on a PNG file and the gAMA chunk will be removed. What's even better is that PNGOut has the best PNG compression around, so you'll end up with a smaller file to boot.</p>

        <p class="tipblock_dark">To use PNGGauntlet: run it, click the <b>Choose Files to Optimize</b> button, select your file/s, leave the <b>Preserve Gamma Information</b> box unchecked, check the <b>Overwrite Original Files</b> box and click <b>Optimize!</b> Some Civ2 graphics can take considerable time to process; it seems to have a difficult time with monochromatic backgrounds - so if you've got a large file, go off and do something else in the meantime. In-game screenshots of a comparable size can be done in a fraction of the time.</p>

        <p>By the way, all of the graphics on this website are either PNGs (8-bit or 24-bit) or GIFs (version 89a with transparency or animation). PNG also supports transparency, but again, this is not supported by all browsers and so it's not an option. For photographs and very large screenshots, use the lossy JPG format.</p>

        <p><img src="images/Troll.gif" width="50" height="48" alt="Catfish"></p>
      </div>

      <div class="post" id="P20050126">
        <div class="title">
          <h3><span class="date">26/01/2005 </span>New Guides Section</h3>
        </div>

        <p>After seeing the same ToT-related questions repeatedly being asked in Civ2 forums, I finally decided to pull my finger out and add a new <a href="jp_guides.htm">Guides section</a> to the site. Hopefully, the information there will be of some benefit to those scenario designers wishing to try their hands at ToT. The section currently contains an <a href="jp_faq.htm">FAQ page</a> and a handful of guides. If I can combat my laziness, I may add more (multi-mapping and transparent colours come to mind) - but I figured I might as well post the ones I've already written.</p>

        <p><img src="images/Yeti.gif" width="41" height="52" alt="Catfish"></p>
      </div>

      <div class="post" id="P20040801">
        <div class="title">
          <h3><span class="date">1/08/2004 </span>Miscellaneous Gibberings</h3>
        </div>

        <p>Progress on the War of the Ring scenario has been spasmodic as my interest in Civ2 waxes and wanes. I'm running only my 5th playtest. The struggles continue with the AI and events space (see the comments below on delayed events).</p>

        <p>I've added a graphics mod pack for ToT's Original game to the <a href="jp_miscgraphics.htm">Miscellaneous Graphics</a> section. It was made a couple of weeks ago for an older person whose eyesight isn't exactly 100% and makes use of team colour masks. It's basically a compilation of user-made and Microprose material; the credits are in the Readme file. It won't be everybody's cup of tea. Take it or leave it.</p>

        <p>The inclusion of animated terrain (which I'd always removed from my game) in the aforementioned mod pack exposed me to a bug whereby the animated terrain file, resource.spr, would interfere with scenarios lacking their own custom resource.spr file - even when the Animated Terrain was turned off under the game's Graphic Options. See <a href="http://apolyton.net/showthread.php/118766-Resource.spr-and-Animated-Terrain">this thread</a> at Apolyton for details. As a result I created a <a href="files/Dummy_Resource.zip">dummy resource.spr</a> file which can (and should, in my opinion :)) be included with any ToT scenario to prevent  such interference. Most veteran gamers tend to ditch terrain animation by renaming the file, but new players won't. Oh and scenario designers should also avoid the animation lockout options in the Scenario Parameters list. They're useless and only impede a player's ability to adjust their settings to the correct ones.</p>

        <h4>About Delay and DelayPerFlag modifiers:</h4>

        <p>From my experience with these, my advice would be to use them sparingly and with caution. Each time a Delay or DelayPerFlag event is called, it is loaded into the memory space shared by all other events. Each delayed event takes up 276 bytes in the .sav file and requires 284 bytes in memory. Repeating Delay/DelayPerFlag events can very quickly eat up your remaining events memory as each stacks up an additional 284 bytes. To avoid problems with these modifiers in your scenario you'll need to calculate the maximum possible number of concurrent Delay/DelayPerFlag events and multiply this figure by 284. The resulting value must not exceed the remaining heap space, as calculated by the events debugger, otherwise there exists the potential for some delayed events to simply not load - although I guess if none of them are game critical, it may not matter.</p>

        <p>Not having read the <i>entire</i> Macro.txt document for a few years, I discovered this the hard way (which includes plenty of obscene language). Shortly after figuring this out I stumbled on these lines at the end of the document:</p>

        <blockquote class="textblock">In addition, delayed actions (those using the DELAY modifier) create countdown timers that also take up memory space. If your delays pile up and you run out of memory because of it, the scenario won't crash, but any delayed actions that don't fit in memory will not ever take place.</blockquote>

        <p>Sigh...</p>

        <h4>Addendum (6/08/2004):</h4>
        
        <p>Man, it certainly pays to read all of the text files, doesn't it? This time from the 1.1 patch readme:</p>

        <blockquote class="textblock">For events files, the Debug file (report.txt) now includes the amount of stack space left for your use. Please note, however, that this total does NOT include the stack space needed by DELAYed events. Each DELAY adds 284 bytes to the space used. Overlapping DELAYs (those whose counters could be running at the same time) add up, but those that do not overlap do not-- i.e. they can re-use the same 284 bytes.</blockquote>

        <p>This would have saved me a lot of grief. If there's any consolation, at least I know I was right on the money. :|</p>

        <p><img src="images/Ogre.gif" width="48" height="52" alt="Catfish"></p>
      </div>

      <div class="post" id="P20040623">
        <div class="title">
          <h3><span class="date">23/06/2004 </span>War of the Ring Progress</h3>
        </div>

        <p>I've been working away on the War of the Ring scenario over the last few nights. My, isn't fleshing out the describe.txt file an exciting task? Copying, pasting, scanning, typing, editing - 21 000 words and counting. I'm also fighting with the events file - fitting all of your events within the 104 kB allocated memory must be akin to trying to stuff a push bike into a Christmas stocking. However, the biggest problem with the scenario is the AI. Now, I've always known that the Civ2 AI was dumb, but trying to get it to jump through the hoops that are the impassable terrain barriers in this scenario is a nightmare. I'm having to divide the map into many MoveUnit cells, each of which directs traffic through the numerous choke points. Of course, each additional MoveUnit event  further reduces my available events space. Then there are those units which are independently assigned ridiculous GoTo orders that they can't possibly hope to carry out. Whinge. Moan.</p>

        <p>In contrast to my gripes, I have to say that the Quest scripting works pretty well - an impossible task without Test of Time's multiple maps and flags. These include the Barrow-downs upgrades, Rivendell and the Council of Elrond (Frodo's arrival/non-arrival, upgrade and spawning of Fellowship members), Gandalf opening the Gates of Moria, Merry/Pippin rousing the Ents, Gandalf rousing Théoden, Aragorn and the Paths of the Dead, Gollum opening the way through Cirith Ungol and of course, the final event: destruction of the Ring in Mount Doom. Lórien (Elven boats and Sam upgrade) has a minor problem. I simply ran out of map transport relationships, so it's possible (but very unlikely - I've made it difficult and unrewarding) to fire this trigger with inappropriate units.</p>

        <p><img src="images/Spider.gif" width="59" height="52" alt="Catfish"></p>
      </div>

      <div class="post" id="P20040610">
        <div class="title">
          <h3><span class="date">10/06/2004 </span>Random Update</h3>
        </div>

        <p>Hmm, so what have I been up to in the realms of Civ2 over the last 3 months? Not much, I'm afraid. I was supposed to be working on my scenario, but only resumed work on the project yesterday. It was not long after my last site update that I let the cat out of the bag in one of the Civ2 forums regarding the project's nature. In February this year, I dusted off my old War of the Ring scenario, decided I didn't like the map and so started over again from scratch. I'll post a few screenshots in the Scenarios section - it may provide me with some additional motivation to get my arse into gear.</p>

        <p>I've got my filthy mitts on a scanner of late and thought I'd take the opportunity to sample some of the newly available source materials for unit creation. A couple of WWII Brits was the result. They're intentionally smaller than my standard man-sized units; make them too large and they dwarf the armour.</p>

        <p><img src="images/Catfish_WWII_Brits.png" width="131" height="66" alt="WWII Brit Units"></p>
      </div>

      <div class="post" id="P20040312">
        <div class="title">
          <h3><span class="date">12/03/2004 </span>El Aurens Beta Released</h3>
        </div>

        <p>Been working on various scenario stuff, both of a graphical and non-graphical nature. In the process, I'm trying not to get distracted by Boco's <a href="http://apolyton.net/forums/showthread.php?s=&amp;threadid=109766">beta release</a> of his superb El Aurens scenario. A lot of time and effort has been poured into this one, so get play-testing! Just to prove that I haven't been sitting on my hands, here's a screenshot of a revamped city screen for a ToT scenario of mine (66% of original size). The original city name and flag have been scrubbed.</p>

        <p><img class="framed" src="images/CityScreen_thumb.png" width="160" height="112" alt="City Screen Thumbnail"></p>

        <p><img src="images/Indiana.gif" width="43" height="52" alt="Catfish"></p>
      </div>

      <div class="post" id="P20040126">
        <div class="title">
          <h3><span class="date">26/01/2004 </span>Sprites Unmasked</h3>
        </div>

        <p>I was playing around with Test of Time's sprites and masks (courtesy of Mercator's CivSprite utility) and came up with the following results:</p>

        <p><img class="framed" src="images/ToTMasks.png" width="279" height="133" alt="ToT Masks"></p>

        <p>The brightness and contrast of the unmasked area (greyscaled) could probably be worked a bit (the mask layer, itself, is either on or off), but it was just an experiment. Not quite as good as the original (inset) but I still may consider its use for some generic units, such as this man-at-arms.</p>

        <p><img src="images/Pandaren.gif" width="50" height="52" alt="Catfish"></p>
      </div>

      <div class="post" id="P20031219">
        <div class="title">
          <h3><span class="date">19/12/2003 </span>New Website</h3>
        </div>

        <p>This is my first attempt at anything website related, whacked together one night using FrontPage. Favouring functionality over design, it's really just a repository for my Civilization 2: Test of Time files - instead of having them scattered all over the Apolyton site. Here, I will post my graphics and scenarios (should I ever finish them and if they'll fit - I've got a 10 Mb limit).</p>

        <p>Catfish</p>
        <p><img src="images/Sasquatch.gif" width="48" height="52" alt="Catfish"></p>
      </div>

    </div>

  </body>

</html>